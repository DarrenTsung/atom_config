/* Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.*/
(function(a){var b={"function":!0,object:!0},c=b[typeof exports]&&exports&&!exports.nodeType&&exports,d=b[typeof self]&&self.Object&&self,e=b[typeof window]&&window&&window.Object&&window,f=b[typeof module]&&module&&!module.nodeType&&module,g=(f&&f.exports===c&&c,c&&f&&"object"==typeof global&&global&&global.Object&&global),h=h=g||e!==(this&&this.window)&&e||d||this;"function"==typeof define&&define.amd?define(["./rx"],function(b,c){return a(h,c,b)}):"object"==typeof module&&module&&module.exports===c?module.exports=a(h,module.exports,require("./rx")):h.Rx=a(h,{},h.Rx)}).call(this,function(a,b,c,d){function e(a){return function(){try{return a.apply(this,arguments)}catch(b){return z.e=b,z}}}function f(a){return a.toArray()}function g(a,b){return a.groupJoin(this,b,q,function(a,b){return b})}function h(a){var b=this;return new s(function(c){var d=new o,e=new k,f=new l(e);return c.onNext(t(d,f)),e.add(b.subscribe(function(a){d.onNext(a)},function(a){d.onError(a),c.onError(a)},function(){d.onCompleted(),c.onCompleted()})),w(a)&&(a=y(a)),e.add(a.subscribe(function(a){d.onCompleted(),d=new o,c.onNext(t(d,f))},function(a){d.onError(a),c.onError(a)},function(){d.onCompleted(),c.onCompleted()})),f},b)}function i(a){var b=this;return new s(function(c){function d(){var b;try{b=a()}catch(f){return void c.onError(f)}w(b)&&(b=y(b));var i=new m;e.setDisposable(i),i.setDisposable(b.take(1).subscribe(v,function(a){h.onError(a),c.onError(a)},function(){h.onCompleted(),h=new o,c.onNext(t(h,g)),d()}))}var e=new n,f=new k(e),g=new l(f),h=new o;return c.onNext(t(h,g)),f.add(b.subscribe(function(a){h.onNext(a)},function(a){h.onError(a),c.onError(a)},function(){h.onCompleted(),c.onCompleted()})),d(),g},b)}var j=c.Observable,k=c.CompositeDisposable,l=c.RefCountDisposable,m=c.SingleAssignmentDisposable,n=c.SerialDisposable,o=c.Subject,p=j.prototype,q=j.empty,r=j.never,s=c.AnonymousObservable,t=(c.Observer.create,c.internals.addRef),u=(c.internals.isEqual,c.internals.inherits),v=c.helpers.noop,w=(c.helpers.identity,c.helpers.isPromise),x=c.helpers.isFunction,y=(c.internals.bindCallback,j.fromPromise),z=(c.ArgumentOutOfRangeError,{e:{}}),A=c.internals.tryCatch=function(a){if(!x(a))throw new TypeError("fn must be a function");return e(a)},B=a.Map||function(){function a(){this.size=0,this._values=[],this._keys=[]}return a.prototype["delete"]=function(a){var b=this._keys.indexOf(a);return-1===b?!1:(this._values.splice(b,1),this._keys.splice(b,1),this.size--,!0)},a.prototype.get=function(a){var b=this._keys.indexOf(a);return-1===b?d:this._values[b]},a.prototype.set=function(a,b){var c=this._keys.indexOf(a);return-1===c?(this._keys.push(a),this._values.push(b),this.size++):this._values[c]=b,this},a.prototype.forEach=function(a,b){for(var c=0;c<this.size;c++)a.call(b,this._values[c],this._keys[c])},a}();p.join=function(a,b,c,d){var e=this;return new s(function(f){var g=new k,h=!1,i=!1,j=0,l=0,n=new B,o=new B,p=function(a){f.onError(a)};return g.add(e.subscribe(function(a){var c=j++,e=new m;n.set(c,a),g.add(e);var i=A(b)(a);return i===z?f.onError(i.e):(e.setDisposable(i.take(1).subscribe(v,p,function(){n["delete"](c)&&0===n.size&&h&&f.onCompleted(),g.remove(e)})),void o.forEach(function(b){var c=A(d)(a,b);return c===z?f.onError(c.e):void f.onNext(c)}))},p,function(){h=!0,(i||0===n.size)&&f.onCompleted()})),g.add(a.subscribe(function(a){var b=l++,e=new m;o.set(b,a),g.add(e);var h=A(c)(a);return h===z?f.onError(h.e):(e.setDisposable(h.take(1).subscribe(v,p,function(){o["delete"](b)&&0===o.size&&i&&f.onCompleted(),g.remove(e)})),void n.forEach(function(b){var c=A(d)(b,a);return c===z?f.onError(c.e):void f.onNext(c)}))},p,function(){i=!0,(h||0===o.size)&&f.onCompleted()})),g},e)},p.groupJoin=function(a,b,c,d){var e=this;return new s(function(f){function g(a){}var h=new k,i=new l(h),j=new B,n=new B,p=0,q=0,g=function(a){return function(b){b.onError(a)}};return h.add(e.subscribe(function(a){var c=new o,e=p++;j.set(e,c);var k=A(d)(a,t(c,i));if(k===z)return j.forEach(g(k.e)),f.onError(k.e);f.onNext(k),n.forEach(function(a){c.onNext(a)});var l=new m;h.add(l);var q=A(b)(a);return q===z?(j.forEach(g(q.e)),f.onError(q.e)):void l.setDisposable(q.take(1).subscribe(v,function(a){j.forEach(g(a)),f.onError(a)},function(){j["delete"](e)&&c.onCompleted(),h.remove(l)}))},function(a){j.forEach(g(a)),f.onError(a)},function(){f.onCompleted()})),h.add(a.subscribe(function(a){var b=q++;n.set(b,a);var d=new m;h.add(d);var e=A(c)(a);return e===z?(j.forEach(g(e.e)),f.onError(e.e)):(d.setDisposable(e.take(1).subscribe(v,function(a){j.forEach(g(a)),f.onError(a)},function(){n["delete"](b),h.remove(d)})),void j.forEach(function(b){b.onNext(a)}))},function(a){j.forEach(g(a)),f.onError(a)})),i},e)},p.buffer=function(){return this.window.apply(this,arguments).flatMap(f)},p.window=function(a,b){return 1===arguments.length&&"function"!=typeof arguments[0]?h.call(this,a):"function"==typeof a?i.call(this,a):g.call(this,a,b)},p.pairwise=function(){var a=this;return new s(function(b){var c,d=!1;return a.subscribe(function(a){d?b.onNext([c,a]):d=!0,c=a},b.onError.bind(b),b.onCompleted.bind(b))},a)},p.partition=function(a,b){return[this.filter(a,b),this.filter(function(c,d,e){return!a.call(b,c,d,e)})]},p.groupBy=function(a,b){return this.groupByUntil(a,b,r)},p.groupByUntil=function(a,b,c){var e=this;return new s(function(f){var g=new B,h=new k,i=new l(h),j=function(a){return function(b){b.onError(a)}};return h.add(e.subscribe(function(e){var k=A(a)(e);if(k===z)return g.forEach(j(k.e)),f.onError(k.e);var l=!1,n=g.get(k);if(n===d&&(n=new o,g.set(k,n),l=!0),l){var p=new C(k,n,i),q=new C(k,n),r=A(c)(q);if(r===z)return g.forEach(j(r.e)),f.onError(r.e);f.onNext(p);var s=new m;h.add(s),s.setDisposable(r.take(1).subscribe(v,function(a){g.forEach(j(a)),f.onError(a)},function(){g["delete"](k)&&n.onCompleted(),h.remove(s)}))}var t=e;return x(b)&&(t=A(b)(e),t===z)?(g.forEach(j(t.e)),f.onError(t.e)):void n.onNext(t)},function(a){g.forEach(j(a)),f.onError(a)},function(){g.forEach(function(a){a.onCompleted()}),f.onCompleted()})),i},e)};var C=function(a){function b(a){return this.underlyingObservable.subscribe(a)}function c(c,d,e){a.call(this,b),this.key=c,this.underlyingObservable=e?new s(function(a){return new k(e.getDisposable(),d.subscribe(a))}):d}return u(c,a),c}(j);return c});
//# sourceMappingURL=rx.coincidence.map